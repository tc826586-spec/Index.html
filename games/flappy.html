<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Bird</title>

<style>
body{
  margin:0;
  background:#70c5ce;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  font-family:Arial,Helvetica,sans-serif;
}
canvas{
  background:#70c5ce;
  border-radius:10px;
}
#info{
  position:absolute;
  top:20px;
  color:#fff;
  font-size:18px;
  font-weight:bold;
}
</style>
</head>

<body>

<div id="info">Click / Tap / Space to Fly</div>
<canvas id="game" width="360" height="520"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let frames = 0;
let score = 0;
let gameOver = false;

/* BIRD */
const bird = {
  x: 60,
  y: 200,
  w: 34,
  h: 24,
  gravity: 0.5,
  jump: 8,
  speed: 0,
  draw(){
    ctx.fillStyle = "#ff0";
    ctx.fillRect(this.x, this.y, this.w, this.h);
  },
  flap(){
    this.speed = -this.jump;
  },
  update(){
    this.speed += this.gravity;
    this.y += this.speed;
    if(this.y + this.h >= canvas.height){
      gameOver = true;
    }
    if(this.y <= 0){
      this.y = 0;
      this.speed = 0;
    }
  }
};

/* PIPES */
const pipes = [];
const gap = 140;

function addPipe(){
  const top = Math.random() * 200 + 40;
  pipes.push({
    x: canvas.width,
    top: top,
    bottom: top + gap,
    w: 50
  });
}

/* DRAW */
function drawPipes(){
  ctx.fillStyle = "#0f0";
  pipes.forEach(p=>{
    ctx.fillRect(p.x, 0, p.w, p.top);
    ctx.fillRect(p.x, p.bottom, p.w, canvas.height);
  });
}

/* UPDATE */
function updatePipes(){
  pipes.forEach(p=>{
    p.x -= 2;

    if(
      bird.x < p.x + p.w &&
      bird.x + bird.w > p.x &&
      (bird.y < p.top || bird.y + bird.h > p.bottom)
    ){
      gameOver = true;
    }

    if(p.x + p.w === bird.x){
      score++;
    }
  });

  if(pipes.length && pipes[0].x + pipes[0].w < 0){
    pipes.shift();
  }

  if(frames % 90 === 0){
    addPipe();
  }
}

/* SCORE */
function drawScore(){
  ctx.fillStyle="#fff";
  ctx.font="28px Arial";
  ctx.fillText(score, canvas.width/2-10, 40);
}

/* GAME LOOP */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(!gameOver){
    bird.update();
    updatePipes();
  }

  drawPipes();
  bird.draw();
  drawScore();

  if(gameOver){
    ctx.fillStyle="rgba(0,0,0,0.6)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#fff";
    ctx.font="24px Arial";
    ctx.fillText("Game Over", 110, 240);
    ctx.font="16px Arial";
    ctx.fillText("Click to Restart", 115, 270);
    return;
  }

  frames++;
  requestAnimationFrame(loop);
}

/* CONTROLS */
document.addEventListener("keydown", e=>{
  if(e.code === "Space"){
    bird.flap();
  }
});

canvas.addEventListener("mousedown", ()=>{
  if(gameOver) location.reload();
  bird.flap();
});

canvas.addEventListener("touchstart", ()=>{
  if(gameOver) location.reload();
  bird.flap();
});

/* START */
loop();
</script>

</body>
</html>
